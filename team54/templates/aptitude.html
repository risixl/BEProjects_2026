<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Aptitude Quiz</title>

  <!-- Load CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

 <style>
    body {
      background: #eef2f7;
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
    }

    #timer-bar {
      position: fixed;
      top: 0;
      width: 100%;
      padding: 12px;
      background: white;
      color: #444;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      z-index: 100;
    }

    .container {
      width: 90%;
      max-width: 800px;
      margin: 100px auto 40px auto;
      background: white;
      padding: 35px;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.12);
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      color: #333;
      margin-bottom: 25px;
    }

    .form-group label {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .form-group select {
      width: 100%;
      padding: 14px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px solid #ccc;
      font-size: 1rem;
    }

    .question {
      background: #f8f9ff;
      padding: 18px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .question p {
      font-size: 1.1rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 12px;
    }

    .options label {
      background: #f0f3ff;
      padding: 14px;
      border-radius: 10px;
      display: block;
      margin-bottom: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .options label:hover {
      background: #e0e6ff;
    }

    input[type="radio"] {
      margin-right: 10px;
      transform: scale(1.2);
    }

    .btn {
      width: 100%;
      padding: 14px;
      margin-top: 25px;
      border-radius: 10px;
      background: #4b70f5;
      color: white;
      font-size: 1.1rem;
      border: none;
      cursor: pointer;
      display: none;
      transition: 0.3s;
    }

    .btn:hover {
      background: #3d5ddb;
    }

    .perf-btn {
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      background: #ffa940;
      color: white;
      border: none;
      font-size: 1.1rem;
      margin-top: 15px;
      cursor: pointer;
      transition: 0.3s;
    }

    .perf-btn:hover {
      background: #ff8b00;
    }

    .footer {
      font-size: 1.3rem;
      text-align: center;
      margin-top: 20px;
      font-weight: bold;
      color: #28a745;
    }
</style>

</head>

<body>

  <!-- TIMER -->
  <div id="timer-bar">
    <span id="time-left">‚è≥ Time Left: 25:00</span>
  </div>

  <div class="container">
    <h1>Aptitude Questions</h1>

    <!-- Topic Selector -->
    <div class="form-group">
      <label>Choose a topic:</label>
      <select id="topic">
        <option value="">--Select Topic--</option>
        <option value="number_system">Number System</option>
        <option value="percentages">Percentages</option>
        <option value="probability">Probability</option>
        <option value="mixtures">Mixtures</option>
        <option value="ages">Ages</option>
        <option value="pipes_and_cisterns">Pipes and Cisterns</option>
        <option value="calendars">Calendars</option>
      </select>
    </div>

    <!-- Formula Box -->
    <div id="formula-container"></div>

    <!-- Questions -->
    <div id="quiz-container"></div>

    <!-- Submit -->
    <button id="submitBtn" class="btn">Submit</button>

    <!-- Score display -->
    <div id="score" class="footer"></div>

    <!-- Performance button -->
    <button onclick="window.location.href='{{ url_for('aptitude_performance') }}'" class="perf-btn">
      üìä View Aptitude Performance
    </button>

    <!-- Back to home -->
    <button onclick="window.location.href='{{ url_for('home') }}'" class="btn" style="display:block;">
      üè† Back to Home
    </button>

    <!-- Retry topic -->
    <button onclick="location.reload()" class="btn" style="display:block;">
      üîÅ Try another topic
    </button>
  </div>

  <!-- Load JS -->
  <script src="{{ url_for('static', filename='js/aptitude1.js') }}"></script>

  <!-- FEEDBACK SCRIPT (ONLY ADDITION) -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const originalSubmit = document.getElementById("submitBtn").onclick;

      // Inject custom feedback after submit
      document.getElementById("submitBtn").onclick = async function () {
        if (originalSubmit) originalSubmit();

        setTimeout(() => {
          const scoreBox = document.getElementById("score");
          if (!scoreBox.innerHTML) return;

          const text = scoreBox.innerText;
          const match = text.match(/Score:\s*(\d+)\/(\d+)/);

          if (!match) return;

          const score = parseInt(match[1]);
          const total = parseInt(match[2]);
          const percent = (score / total) * 100;

          let feedback = "";

          if (percent >= 80) feedback = "üåü Excellent performance! Keep it up.";
          else if (percent >= 60) feedback = "üëç Good job! You're improving.";
          else if (percent >= 40) feedback = "‚ö†Ô∏è Needs more practice.";
          else feedback = "‚ùå Weak topic. Please revise again.";

          scoreBox.innerHTML += `<br><br><span style='color:#ff6600;'>${feedback}</span>`;
        }, 300);
      };
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</body>
</html>
