# Sepsis Detection Platform using Variational Autoencoders (VAE)

A comprehensive full-stack web application for early sepsis detection using advanced machine learning models. This platform features both original Random Forest and VAE-enhanced models for accurate sepsis prediction.

## ğŸ¯ Project Overview

This project implements a complete end-to-end system for sepsis detection, including:
- **Complete ML Pipeline**: Automated data processing, model training, and inference
- **Full-Stack Web Application**: React frontend + Node.js backend + Python ML services
- **Role-Based Access Control**: Separate interfaces for doctors and patients
- **Multiple Input Methods**: File upload (CSV, PDF, DOCX, images) or manual entry
- **Comprehensive Reporting**: PDF reports with detailed metrics and recommendations

## âœ¨ Features

### Machine Learning
- âœ… Automated PhysioNet dataset download (with fallback synthetic data)
- âœ… Data preprocessing with forward/backward fill and MinMax scaling
- âœ… Original Random Forest model training
- âœ… Variational Autoencoder (VAE) for synthetic data generation
- âœ… Combined model training (real + synthetic data)
- âœ… Model comparison metrics (Accuracy, Precision, Recall, F1 Score)

### Backend (Node.js + Express)
- âœ… RESTful API with JWT authentication
- âœ… Role-based access control (Doctors vs Patients)
- âœ… File parsing (CSV, PDF, DOCX, TXT, Excel, Images with OCR)
- âœ… Python ML service integration
- âœ… PDF report generation (doctor & patient versions)
- âœ… DoctorsRecord collection linking doctors to patient uploads
- âœ… Activity logging & patient-access enforcement

### Frontend (React + Tailwind)
- âœ… Beautiful, responsive UI
- âœ… Doctor dashboard with live metrics and recent uploads
- âœ… Patient dashboard with strict access controls
- âœ… File upload interface with automatic data extraction
- âœ… Manual data entry form (doctors only)
- âœ… Prediction results with model comparison bar charts
- âœ… PDF report download for both roles

## Project Structure

```
sepsis-detection-platform/
â”œâ”€â”€ backend/          # Node.js/Express backend
â”œâ”€â”€ ml/              # Python ML pipeline
â””â”€â”€ frontend/        # React frontend
```

## ğŸš€ Quick Start

See [QUICKSTART.md](QUICKSTART.md) for a 5-minute setup guide.

### Prerequisites
- Node.js (v16+)
- Python (v3.8+)
- MongoDB
- npm/yarn

### Installation

1. **Clone and install dependencies:**
```bash
# Backend
cd backend && npm install

# Frontend
cd frontend && npm install

# ML Pipeline
cd ml && pip install -r requirements.txt
```

2. **Configure environment variables:**
   - Copy `backend/.env.example` to `backend/.env` and fill in values
   - Copy `frontend/.env.example` to `frontend/.env` and set API URL

3. **Train ML models:**
```bash
cd ml
python train/run_all.py
```

4. **Start services:**
```bash
# Terminal 1: MongoDB
mongod

# Terminal 2: Backend
cd backend && npm start

# Terminal 3: Frontend
cd frontend && npm run dev
```

5. **Access application:**
   - Frontend: http://localhost:5173
   - Backend API: http://localhost:5000

## ğŸ“ Project Structure

```
sepsis-detection-platform/
â”œâ”€â”€ backend/              # Node.js/Express backend
â”‚   â”œâ”€â”€ config/          # Database configuration
â”‚   â”œâ”€â”€ controllers/     # Route controllers
â”‚   â”œâ”€â”€ middleware/      # Auth & error handling
â”‚   â”œâ”€â”€ models/          # MongoDB models
â”‚   â”œâ”€â”€ routes/          # API routes
â”‚   â”œâ”€â”€ services/        # Business logic services
â”‚   â””â”€â”€ server.js        # Express server
â”‚
â”œâ”€â”€ ml/                  # Python ML pipeline
â”‚   â”œâ”€â”€ data/           # Raw, processed, synthetic data
â”‚   â”œâ”€â”€ models/         # Trained models (.pkl files)
â”‚   â”œâ”€â”€ train/          # Training scripts
â”‚   â””â”€â”€ inference/      # Prediction scripts
â”‚
â””â”€â”€ frontend/           # React frontend
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/ # Reusable components
    â”‚   â”œâ”€â”€ pages/      # Page components
    â”‚   â””â”€â”€ utils/      # Utilities
    â””â”€â”€ public/         # Static assets
```

## ğŸ” Authentication & Roles

### Doctors
- Email domain: `@cmrit.ac.in`
- Can upload files and enter data manually
- Can view all patient records
- Can see detailed metrics and model comparisons
- Can edit suggestions
- Can download detailed PDF reports

### Patients
- Any non-`@cmrit.ac.in` email
- Login allowed only if a doctor has uploaded their record
- Can only view their own reports, charts, and suggestions
- Can download simplified PDF reports
- Cannot upload files or edit suggestions

## ğŸ“Š Model Comparison

The platform uses two models:
1. **Original Random Forest**: Trained on real PhysioNet data
2. **VAE-Enhanced Model**: Trained on real + synthetic data generated by VAE

Both models are compared side-by-side with metrics:
- Accuracy
- Precision
- Recall
- F1 Score

## ğŸ“„ File Formats Supported

- **CSV**: Direct parsing of patient data
- **PDF**: Text extraction and pattern matching
- **DOCX**: Document parsing
- **Images**: OCR using Tesseract.js (JPG, PNG)

## ğŸ› ï¸ Development

### Running in Development Mode

```bash
# Backend with auto-reload
cd backend && npm run dev

# Frontend with hot-reload
cd frontend && npm run dev
```

### Testing ML Pipeline

```bash
cd ml
python inference/predict.py
```

## ğŸ“ API Endpoints

- `POST /api/auth/register` - User registration (auto role detection)
- `POST /api/auth/login` - User login with DoctorsRecord validation for patients
- `POST /api/predict/predict` - Make prediction (doctor only)
- `GET /api/predict/:id` - Get prediction result
- `GET /api/predict/:id/download` - Download PDF report
- `POST /api/file/upload` - Upload and parse patient file (doctor only)
- `GET /api/doctor/records` - Get all records (doctor only)
- `GET /api/patient/records` - Get patient's records

## ğŸ› Troubleshooting

See [SETUP.md](SETUP.md) for detailed troubleshooting guide.

Common issues:
- **Models not found**: Run `python ml/train/run_all.py`
- **MongoDB error**: Ensure MongoDB is running
- **Email not sending**: Check SMTP credentials
- **Python errors**: Verify Python path in `.env`

## ğŸ“š Documentation

- [QUICKSTART.md](QUICKSTART.md) - 5-minute setup guide
- [SETUP.md](SETUP.md) - Detailed setup instructions

## ğŸ“ Academic Context

This project implements:
- Variational Autoencoders for synthetic data generation
- Random Forest for classification
- Data augmentation techniques
- Model ensemble methods

## ğŸ“„ License

MIT License - See LICENSE file for details

## ğŸ‘¥ Credits

Built for sepsis detection research using PhysioNet datasets and VAE techniques.

